(this["webpackJsonpcard-dnd"]=this["webpackJsonpcard-dnd"]||[]).push([[0],{117:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(41),d=n.n(c),i=n(11),s=n(21),l=n(43),o=n(16),u=n(6),f=n(7),g="card",m=function(e){var t=e.url;return a.a.createElement("div",{className:"card-outer"},a.a.createElement("div",{className:"card-inner"},a.a.createElement("img",{src:t,width:"60",height:"84",draggable:"false"})))},I=function(e){var t=e.cards;return a.a.createElement("div",null,t.slice(0,3).map((function(e,n){return a.a.createElement("div",{key:e.id,className:"card card-dragged",style:{zIndex:t.length-n,transform:"rotateZ(".concat(2.5*-n,"deg)")}},a.a.createElement(m,{url:e.url}))})))},v={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,right:0,bottom:0},E=function(e){if(!e)return{display:"none"};var t=e.x,n=e.y;return{transform:"translate(".concat(t,"px, ").concat(n,"px)"),filter:"drop-shadow(0 2px 12px rgba(0,0,0,0.45))"}};function h(){var e=Object(i.useDragLayer)((function(e){return{item:e.getItem(),itemType:e.getItemType(),currentOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}})),t=e.itemType,n=e.isDragging,r=e.item,c=e.currentOffset;return n?a.a.createElement("div",{style:v},a.a.createElement("div",{style:E(c)},function(e,t){switch(e){case g:return a.a.createElement(I,{cards:t.cardsDragStack});default:return null}}(t,r))):null}var p=n(40);function x(e){var t=Object(r.useRef)(null),n=Object(i.useDrag)({type:g,item:function(t){var n,r={id:e.id,order:e.order,url:e.url};e.selectedCards.find((function(t){return t.id===e.id}))?n=e.selectedCards:(e.clearItemSelection(),n=[r]);var a=n.concat();a.splice(n.findIndex((function(t){return t.id===e.id})),1);var c=[r].concat(Object(u.a)(a)),d=n.map((function(e){return e.id}));return{cards:n,cardsDragStack:c,draggedCard:r,cardsIDs:d}},isDragging:function(t){return t.getItem().cardsIDs.includes(e.id)},end:function(t,n){e.rearrangeCards(t),e.clearItemSelection()},collect:function(e){return{isDragging:e.isDragging()}}}),c=Object(o.a)(n,3),d=c[0].isDragging,s=c[1],l=c[2],f=Object(i.useDrop)({accept:g,hover:function(n,r){var a,c=n.draggedCard.index,d=e.index,i=null===(a=t.current)||void 0===a?void 0:a.getBoundingClientRect(),s=i.left+(i.right-i.left)/2,l=r.getClientOffset().x<s?d:d+1;e.setInsertIndex(c,d,l)},collect:function(e){return{hovered:e.isOver()}}}),I=Object(o.a)(f,2),v=I[0].hovered;s((0,I[1])(t));Object(r.useEffect)((function(){l(Object(p.a)(),{captureDraggingState:!0})}),[]);var E=e.url,h=d?.4:1,x=[];return e.isSelected&&x.push("card-wrapper-selected"),a.a.createElement("div",{key:"card-div-"+e.id,style:{position:"relative"}},e.insertLineOnLeft&&v&&a.a.createElement("div",{className:"insert-line-left"}),a.a.createElement("div",{className:"card-wrapper "+x.join(" ")},a.a.createElement("div",{ref:t,className:"card",onClick:function(t){e.onSelectionChange(e.index,t.metaKey,t.shiftKey)},style:{opacity:h}},a.a.createElement(m,{url:E}))),e.insertLineOnRight&&v&&a.a.createElement("div",{className:"insert-line-right"}))}var C=function(e,t){switch(t.type){case"CLEAR_SELECTION":return Object(f.a)(Object(f.a)({},e),{},{selectedCards:y.selectedCards,lastSelectedIndex:y.lastSelectedIndex});case"UPDATE_SELECTION":return Object(f.a)(Object(f.a)({},e),{},{selectedCards:t.newSelectedCards,lastSelectedIndex:t.newLastSelectedIndex});case"REARRANGE_CARDS":return Object(f.a)(Object(f.a)({},e),{},{cards:t.newCards});case"SET_INSERTINDEX":return Object(f.a)(Object(f.a)({},e),{},{dragIndex:t.dragIndex,hoverIndex:t.hoverIndex,insertIndex:t.insertIndex});default:throw new Error}},O=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e)+e)},S=["A","2","3","4","5","6","7","8","9","T","J","Q","K","X"],b=["C","D","H","S"],y={cards:Object(u.a)(Array(50).keys()).map((function(e){return{id:e+1,order:e,url:"/card-dnd/resources/"+S[O(0,S.length)]+b[O(0,b.length)]+".svg"}})),selectedCards:[],lastSelectedIndex:-1,dragIndex:-1,hoverIndex:-1,insertIndex:-1,isDragging:!1};function j(){var e=Object(r.useReducer)(C,y),t=Object(o.a)(e,2),n=t[0],c=t[1],d=function(){c({type:"CLEAR_SELECTION"})},i=function(e,t,r){var a,d=n.cards,i=e<0?"":d[e],s=e;if(t||r){if(r)a=n.lastSelectedIndex>=e?[].concat.apply(n.selectedCards,d.slice(e,n.lastSelectedIndex)):[].concat.apply(n.selectedCards,d.slice(n.lastSelectedIndex+1,e+1));else if(t){var l=n.selectedCards.findIndex((function(e){return e===i}));a=l>=0?[].concat(Object(u.a)(n.selectedCards.slice(0,l)),Object(u.a)(n.selectedCards.slice(l+1))):[].concat(Object(u.a)(n.selectedCards),[i])}}else a=[i];var o=d?d.filter((function(e){return a.find((function(t){return t===e}))})):[];c({type:"UPDATE_SELECTION",newSelectedCards:o,newLastSelectedIndex:s})},s=function(e){var t,r=n.cards.slice(),a=e.cards;t=n.insertIndex>=0&n.insertIndex<r.length?n.insertIndex:r.length;var d=r.slice(0,t).filter((function(e){return!a.find((function(t){return t.id===e.id}))})),i=r.slice(t).filter((function(e){return!a.find((function(t){return t.id===e.id}))})),s=[].concat(Object(u.a)(d),Object(u.a)(a),Object(u.a)(i));c({type:"REARRANGE_CARDS",newCards:s})},l=function(e,t,r){n.dragIndex===e&&n.hoverIndex===t&&n.insertIndex===r||c({type:"SET_INSERTINDEX",dragIndex:e,hoverIndex:t,insertIndex:r})};return a.a.createElement("main",null,a.a.createElement(h,null),a.a.createElement("div",{className:"container"},n.cards.map((function(e,t){var r=n.hoverIndex===t&&n.insertIndex===t,c=n.hoverIndex===t&&n.insertIndex===t+1;return a.a.createElement(x,{key:"card-"+e.id,id:e.id,index:t,order:e.order,url:e.url,selectedCards:n.selectedCards,rearrangeCards:s,setInsertIndex:l,onSelectionChange:i,clearItemSelection:d,isSelected:n.selectedCards.includes(e),insertLineOnLeft:r,insertLineOnRight:c})}))))}n(117);function D(){var e=function(){try{var e=" -webkit- -moz- -o- -ms- ".split(" ");return"ontouchstart"in window||"undefined"!==typeof window.DocumentTouch&&document instanceof window.DocumentTouch||(t=["(",e.join("touch-enabled),("),"heartz",")"].join(""),window.matchMedia(t).matches)}catch(n){return console.error("(Touch detect failed)",n),!1}var t}()?l.a:s.a;return a.a.createElement("div",{className:"App"},a.a.createElement("h2",null,"Drag and drop multiple items with React DnD"),a.a.createElement("h4",null,"Use Shift or Cmd key to multi-select"),a.a.createElement(i.DndProvider,{backend:e},a.a.createElement(j,null)))}var w=document.getElementById("root");d.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(D,null)),w)},44:function(e,t,n){e.exports=n(118)}},[[44,1,2]]]);
//# sourceMappingURL=main.0f6af883.chunk.js.map